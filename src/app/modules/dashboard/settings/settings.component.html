<div class="card">
  <p-tabView>
    <p-tabPanel header="General">
      <p-fieldset legend="Storage" [toggleable]="true">
        <div class="container-grid">
          <div class="m-1">
            <h4 class="text-xl font-bold">Directory</h4>
            <span class="text-base">Choose a directory to work with</span>
          </div>
          <div class="m-2">
            <div class="p-inputgroup">
              <button
                type="button"
                pButton
                pRipple
                icon="pi pi-folder"
                (click)="updateDirectory()"
              ></button>
              <input
                type="text"
                pInputText
                [(ngModel)]="configSettings.baseDirectory"
              />
            </div>
          </div>
        </div>
      </p-fieldset>
      <ng-container *ngTemplateOutlet="settingsActionTemplate"></ng-container>
    </p-tabPanel>

    <!-- - Screenshot Tab -->

    <p-tabPanel header="Screenshot">
      <p-fieldset legend="Key Binds" [toggleable]="true">
        <div class="container-grid">
          <div class="m-1">
            <h4 class="text-xl font-bold">Key Combinations</h4>
            <span class="text-base"
              >Set up key combinations for taking screenshots</span
            >
          </div>
          <div class="m-2">
            <div class="p-inputgroup">
              <button
                type="button"
                pButton
                pRipple
                icon="pi pi-folder"
                (click)="keybindSelectionActive = 'ss'"
              ></button>
              <input
                type="text"
                disabled
                pInputText
                [value]="configSettings.ssHotKey"
              />
              <p-dialog
                (onHide)="removeListenerAndUpdateKeybind('ss')"
                (onShow)="listenForKeybinds()"
                [focusTrap]="true"
                [focusOnShow]="true"
                [modal]="true"
                [resizable]="true"
                header="Listening for new Keybind"
                [closable]="false"
                [visible]="keybindSelectionActive === 'ss'"
                [style]="{
                  width: '50vw',
                  height: '50vh'
                }"
              >
                <span>{{ recordedKeybind }}</span>
                <ng-template pTemplate="footer">
                  <p-button
                    icon="pi pi-check"
                    (click)="keybindSelectionActive = null"
                    label="Okay"
                    styleClass="p-button-text"
                  ></p-button>
                </ng-template>
              </p-dialog>
            </div>
          </div>
        </div>
      </p-fieldset>
      <ng-container *ngTemplateOutlet="settingsActionTemplate"></ng-container>
    </p-tabPanel>

    <!-- - Screen Recorder Tab -->

    <p-tabPanel header="Screen Recording">
      <p-fieldset legend="Key Binds" [toggleable]="true">
        <div class="container-grid">
          <div class="m-1">
            <h4 class="text-xl font-bold">Key Combinations</h4>
            <span class="text-base"
              >Set up key combinations for enabling Screen Capture</span
            >
          </div>
          <div class="m-2">
            <div class="p-inputgroup">
              <button
                type="button"
                pButton
                pRipple
                icon="pi pi-folder"
                (click)="keybindSelectionActive = 'sc'"
              ></button>
              <input
                type="text"
                disabled
                pInputText
                [value]="configSettings.scHotKey"
              />
              <p-dialog
                (onHide)="removeListenerAndUpdateKeybind('sc')"
                (onShow)="listenForKeybinds()"
                [focusTrap]="true"
                [focusOnShow]="true"
                [modal]="true"
                [resizable]="true"
                header="Listening for new Keybind"
                [closable]="false"
                [visible]="keybindSelectionActive === 'sc'"
                [style]="{
                  width: '50vw',
                  height: '50vh'
                }"
              >
                <span>{{ recordedKeybind }}</span>
                <ng-template pTemplate="footer">
                  <p-button
                    icon="pi pi-check"
                    (click)="keybindSelectionActive = null"
                    label="Okay"
                    styleClass="p-button-text"
                  ></p-button>
                </ng-template>
              </p-dialog>
            </div>
          </div>
        </div>
      </p-fieldset>
      <ng-container *ngTemplateOutlet="settingsActionTemplate"></ng-container>
    </p-tabPanel>
  </p-tabView>
</div>

<!-- - Tab Action Items Template -->

<ng-template #settingsActionTemplate>
  <div class="flex justify-end m-4">
    <button
      pButton
      pRipple
      type="button"
      label="Save"
      class="p-button-raised p-button-sm mx-2"
      (click)="saveSettings()"
    ></button>
    <button
      pButton
      pRipple
      type="button"
      label="Cancel"
      class="p-button-outlined p-button-sm mx-2"
      (click)="cancelSettings()"
    ></button>
  </div>
</ng-template>
