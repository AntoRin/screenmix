<p-contextMenu [model]="contextMenuOptions" [baseZIndex]="10000" #contextMenuRef></p-contextMenu>
<div *ngIf="!PREFERENCES.baseDirectory" class="absolute top-2/4 left-2/4 transform -translate-x-1/2 -translate-y-1/2">
   <p-button
      (click)="tabChangeEvent.emit('workspaces')"
      label="No workspace selected. Go to your workspaces"
      styleClass="p-button-link"
      icon="pi pi-arrow-circle-right"
      iconPos="right"
   ></p-button>
</div>
<div
   #mediaItems
   class="grid m-2 gap-2"
   style="grid-template-columns: repeat(auto-fill, minmax(300px, 1fr)); grid-auto-rows: 200px"
   *ngIf="PREFERENCES.baseDirectory"
>
   <div
      *ngFor="let mediaFile of mediaFiles; let mediaIdx = index"
      (contextmenu)="showContextMenu($event, mediaFile)"
      class="relative m-2 bg-black flex justify-center items-center overflow-hidden"
      [ngClass]="[
         selectMode ? (mediaFile.customData?.['selected'] ? 'border-4 border-solid border-blue-500' : '') : ''
      ]"
      [style]="mediaFileFilter === mediaFile.type ? 'display: block' : 'display: none !important'"
   >
      <img
         *ngIf="mediaFile.type === 'image'"
         (click)="selectMode ? selectItem(mediaIdx) : showImageInSpotlight(mediaIdx)"
         [src]="mediaFile.path"
         class="object-contain h-full w-full cursor-pointer image-item"
         alt=""
      />
      <div *ngIf="mediaFile.type === 'video'">
         <span class="text-teal-200 cursor-pointer absolute-centre z-10" (click)="playVideo(VideoElement)">
            <svg
               class="text-teal-100 dark:text-white"
               style="width: 50px"
               xmlns="http://www.w3.org/2000/svg"
               fill="none"
               viewBox="0 0 24 24"
               stroke-width="1.5"
               stroke="currentColor"
            >
               <path stroke-linecap="round" stroke-linejoin="round" d="M21 12a9 9 0 11-18 0 9 9 0 0118 0z" />
               <path
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  d="M15.91 11.672a.375.375 0 010 .656l-5.603 3.113a.375.375 0 01-.557-.328V8.887c0-.286.307-.466.557-.327l5.603 3.112z"
               />
            </svg>
         </span>
         <video
            #VideoElement
            class="h-full w-full object-contain"
            [src]="mediaFile.path"
            (click)="selectMode ? selectItem(mediaIdx, $event) : true"
            (play)="handleVideoPlay($event)"
            preload="metadata"
         ></video>
      </div>
   </div>
</div>

<!-- - Spotlight Image -->
<div
   *ngIf="spotlightImage && !editing"
   (click)="previousImage()"
   class="absolute left-2 top-[50%] translate-y-[-50%] z-[55] cursor-pointer"
>
   <i class="pi pi-angle-left text-5xl text-white"></i>
</div>
<div
   *ngIf="spotlightImage && !editing"
   (click)="nextImage()"
   class="absolute right-2 top-[50%] translate-y-[-50%] z-[55] cursor-pointer"
>
   <i class="pi pi-angle-right text-5xl text-white"></i>
</div>

<app-image-viewer
   *ngIf="spotlightImage"
   [editing]="editing"
   [spotlightImage]="spotlightImage"
   [previewMode]="previewMode"
   (viewerEvent)="handleViewerEvent($event)"
></app-image-viewer>
